<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Apple Trade ‚Äî Canje iPhone</title>

  <style>
    :root{
      --primary:#0071e3;
      --bg:#f5f5f7;
      --text:#1d1d1f;
      --muted:#6e6e73;
      --border:rgba(0,0,0,.08);
      --usd:#16a34a;
      --wa:#25D366;
      --shadow: 0 10px 26px rgba(0,0,0,.06);
      --shadow-hover: 0 16px 42px rgba(0,0,0,.10);
    }

    *{ box-sizing:border-box; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif; }
    body{ margin:0; background:var(--bg); color:var(--text); }

    header{
      background:rgba(255,255,255,.9);
      backdrop-filter:blur(10px);
      border-bottom:1px solid var(--border);
      padding:18px;
      text-align:center;
      font-weight:700;
      font-size:1.15rem;
      position:sticky;
      top:0;
      z-index:10;
    }

    main{ max-width:1200px; margin:auto; padding:20px; }

    .filters{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:14px;
    }

    select{
      padding:12px;
      border-radius:12px;
      border:1px solid var(--border);
      min-width:220px;
      background:white;
    }

    .toolbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:16px;
      gap:10px;
      flex-wrap:wrap;
    }

    .results-count{
      color:var(--muted);
      font-size:.9rem;
      font-weight:600;
    }

    .products{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:18px;
    }

    .product{
      background:white;
      border-radius:18px;
      padding:18px;
      box-shadow:var(--shadow);
      border:1px solid var(--border);
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      transition:.2s;
    }

    .product:hover{
      transform:translateY(-3px);
      box-shadow:var(--shadow-hover);
    }

    .product h3{
      margin:0 0 4px;
      font-size:1.05rem;
    }

    .condition-text{
      font-size:.85rem;
      color:var(--muted);
      margin-bottom:6px;
    }

    .details{
      font-size:.9rem;
      margin-bottom:8px;
      color:#515154;
    }

    .price-usd{ color:var(--usd); font-weight:800; font-size:1.1rem; }
    .price-ars{ font-weight:700; }

    .installments{ font-size:.9rem; color:#555; }

    button{
      margin-top:14px;
      padding:12px;
      border-radius:14px;
      border:none;
      background:var(--primary);
      color:white;
      font-size:1rem;
      font-weight:700;
      cursor:pointer;
    }

    button:hover{ opacity:.95; }

    /* MODAL */
    .modal{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:20px;
      z-index:999;
    }

    .modal-content{
      background:white;
      border-radius:18px;
      padding:20px;
      width:100%;
      max-width:520px;
    }

    .result{
      background:#f6f7fb;
      padding:14px;
      border-radius:14px;
      margin-top:10px;
      min-height:62px;
      line-height:1.25rem;
    }

    .modal-actions{
      display:flex;
      gap:10px;
      margin-top:12px;
      flex-wrap:wrap;
    }

    /* BOT√ìN WHATSAPP (SIN ICONO) */
    .wa-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      height:44px;
      padding:0 20px;
      border-radius:14px;
      background:var(--wa);
      color:white;
      font-weight:800;
      font-size:.95rem;
      text-decoration:none;
      min-width:180px;
      box-shadow:0 10px 22px rgba(37,211,102,.20);
    }
    .wa-btn:hover{ opacity:.95; }

    .close{
      background:#e5e5ea;
      color:#111;
      border:none;
      border-radius:14px;
      padding:0 20px;
      height:44px;
      font-weight:700;
      cursor:pointer;
    }

    .warning{
      font-size:.8rem;
      color:#6b7280;
      margin-top:14px;
    }
  </style>
</head>

<body>

<header>
  Renov√° tu iPhone en Apple Trade con la mejor cotizaci√≥n
</header>

<main>

  <div class="filters">
    <select id="filterLine">
      <option value="">Filtrar por modelo</option>
      <option value="11">iPhone 11</option>
      <option value="12">iPhone 12</option>
      <option value="13">iPhone 13</option>
      <option value="14">iPhone 14</option>
      <option value="15">iPhone 15</option>
      <option value="16">iPhone 16</option>
    </select>

    <select id="filterCondition">
      <option value="">Nuevo o seminuevo</option>
      <option value="Seminuevo">Seminuevo</option>
      <option value="Nuevo">Nuevo</option>
    </select>

    <button class="close" id="clearFilters">Limpiar filtros</button>
  </div>

  <div class="toolbar">
    <div class="results-count" id="resultsCount"></div>

    <select id="sortPrice">
      <option value="">Ordenar por</option>
      <option value="asc">Precio menor a mayor</option>
      <option value="desc">Precio mayor a menor</option>
    </select>
  </div>

  <section class="products" id="productList"></section>
</main>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content">
    <h2>Cotizaci√≥n de Canje</h2>

    <label>iPhone que entreg√°s</label>
    <select id="tradeInSelect"></select>

    <label>iPhone que quer√©s</label>
    <select id="buySelect"></select>

    <div class="result" id="result"></div>

    <div class="modal-actions">
      <a id="whatsappBtn" class="wa-btn" href="#" target="_blank" rel="noopener">
        Canjear ahora
      </a>
      <button class="close" onclick="closeModal()">Cerrar</button>
    </div>

    <div class="warning">
      * Cotizaci√≥n estimada, sujeta a revisi√≥n del equipo entregado.
    </div>
  </div>
</div>

<script>
  /* =========================
     CONFIGURACI√ìN FINANCIERA
  ========================== */
  let USD_TO_ARS = 1550;      // ‚úÖ d√≥lar actualizado
  let INTEREST_3 = 1.3816;    // ‚úÖ inter√©s 3 cuotas
  let INTEREST_6 = 1.518;     // ‚úÖ inter√©s 6 cuotas

  /* WhatsApp (formato internacional sin +, sin espacios) */
  const WHATSAPP_NUMBER = "54911XXXXXXXX";

  function calculatePrices(usd){
    const ars = usd * USD_TO_ARS;
    return {
      usd,
      ars,
      c3:(ars * INTEREST_3) / 3,
      c6:(ars * INTEREST_6) / 6
    };
  }

  /* =========================
     PRODUCTOS EN VENTA (EJEMPLO)
     (Pod√©s reemplazarlos por tu stock real)
  ========================== */
  const products = [
    { model:"iPhone 12 Pro", storage:"128GB", condition:"Seminuevo", details:"Azul ¬∑ Bater√≠a 100%", priceUSD:350 },
    { model:"iPhone 13 Pro", storage:"128GB", condition:"Seminuevo", details:"Celeste ¬∑ Bater√≠a 100%", priceUSD:495 },
    { model:"iPhone 14 Pro", storage:"256GB", condition:"Seminuevo", details:"Negro ¬∑ Bater√≠a 100%", priceUSD:600 },
    { model:"iPhone 15 Pro Max", storage:"256GB", condition:"Seminuevo", details:"Azul ¬∑ Bater√≠a 90%", priceUSD:785 }
  ];

  /* =========================
     TRADE-IN (iPhone que entreg√°s)
     ‚úÖ Se carga como cat√°logo con modelo + capacidad + valor USD
  ========================== */
  const tradeInCatalog = [
    { model:"iPhone 11", storage:"128GB", usd:100 },
    { model:"iPhone 11 Pro", storage:"256GB", usd:100 },
    { model:"iPhone 11 Pro Max", storage:"256GB", usd:100 },

    { model:"iPhone 12", storage:"128GB", usd:120 },
    { model:"iPhone 12", storage:"256GB", usd:120 },
    { model:"iPhone 12 Pro", storage:"128GB", usd:150 },
    { model:"iPhone 12 Pro", storage:"256GB", usd:160 },
    { model:"iPhone 12 Pro Max", storage:"128GB", usd:150 },
    { model:"iPhone 12 Pro Max", storage:"256GB", usd:160 },

    { model:"iPhone 13", storage:"128GB", usd:250 },
    { model:"iPhone 13", storage:"256GB", usd:260 },
    { model:"iPhone 13 Pro", storage:"128GB", usd:300 },
    { model:"iPhone 13 Pro", storage:"256GB", usd:310 },
    { model:"iPhone 13 Pro Max", storage:"128GB", usd:370 },
    { model:"iPhone 13 Pro Max", storage:"256GB", usd:390 },

    { model:"iPhone 14", storage:"128GB", usd:250 },
    { model:"iPhone 14", storage:"256GB", usd:260 },
    { model:"iPhone 14 Plus", storage:"128GB", usd:250 },
    { model:"iPhone 14 Plus", storage:"256GB", usd:260 },
    { model:"iPhone 14 Pro", storage:"128GB", usd:350 },
    { model:"iPhone 14 Pro", storage:"256GB", usd:370 },
    { model:"iPhone 14 Pro Max", storage:"128GB", usd:420 },
    { model:"iPhone 14 Pro Max", storage:"256GB", usd:440 },

    { model:"iPhone 15", storage:"128GB", usd:370 },
    { model:"iPhone 15", storage:"256GB", usd:380 },
    { model:"iPhone 15 Plus", storage:"128GB", usd:370 },
    { model:"iPhone 15 Plus", storage:"256GB", usd:380 },
    { model:"iPhone 15 Pro", storage:"128GB", usd:460 },
    { model:"iPhone 15 Pro", storage:"256GB", usd:480 },
    { model:"iPhone 15 Pro Max", storage:"256GB", usd:550 },
    { model:"iPhone 15 Pro Max", storage:"512GB", usd:560 },

    { model:"iPhone 16e", storage:"128GB", usd:350 },
    { model:"iPhone 16e", storage:"256GB", usd:360 },
    { model:"iPhone 16", storage:"128GB", usd:550 },
    { model:"iPhone 16", storage:"256GB", usd:560 },
    { model:"iPhone 16 Plus", storage:"128GB", usd:550 },
    { model:"iPhone 16 Plus", storage:"256GB", usd:560 },
    { model:"iPhone 16 Pro", storage:"128GB", usd:650 },
    { model:"iPhone 16 Pro", storage:"256GB", usd:670 },
    { model:"iPhone 16 Pro Max", storage:"256GB", usd:770 },
    { model:"iPhone 16 Pro Max", storage:"512GB", usd:800 }
  ];

  /* =========================
     DOM
  ========================== */
  const productList = document.getElementById("productList");
  const modal = document.getElementById("modal");
  const tradeInSelect = document.getElementById("tradeInSelect");
  const buySelect = document.getElementById("buySelect");
  const result = document.getElementById("result");
  const whatsappBtn = document.getElementById("whatsappBtn");

  /* =========================
     RENDER PRODUCTOS
  ========================== */
  function renderProducts(){
    productList.innerHTML="";
    let list=[...products];

    const fLine=document.getElementById("filterLine").value;
    const fCond=document.getElementById("filterCondition").value;
    const sort=document.getElementById("sortPrice").value;

    if(fLine) list=list.filter(p=>p.model.includes(`iPhone ${fLine}`));
    if(fCond) list=list.filter(p=>p.condition===fCond);

    if(sort==="asc") list.sort((a,b)=>a.priceUSD-b.priceUSD);
    if(sort==="desc") list.sort((a,b)=>b.priceUSD-a.priceUSD);

    document.getElementById("resultsCount").textContent=`${list.length} equipos disponibles`;

    list.forEach(p=>{
      const pr=calculatePrices(p.priceUSD);
      const card=document.createElement("div");
      card.className="product";
      card.innerHTML=`
        <div>
          <h3>${p.model} ${p.storage}</h3>
          <div class="condition-text">${p.condition}</div>
          <div class="details">${p.details}</div>
          <div class="price-usd">USD ${pr.usd}</div>
          <div class="price-ars">ARS ${pr.ars.toLocaleString()}</div>
          <div class="installments">3 cuotas: ARS ${pr.c3.toLocaleString()}</div>
          <div class="installments">6 cuotas: ARS ${pr.c6.toLocaleString()}</div>
        </div>
        <button onclick="openModal(${products.indexOf(p)})">Cotizar canje</button>
      `;
      productList.appendChild(card);
    });
  }

  /* =========================
     MODAL
  ========================== */
  function openModal(i){
    modal.style.display="flex";
    result.innerHTML="";
    whatsappBtn.href="#";

    // Selector trade-in (modelo + capacidad)
    tradeInSelect.innerHTML="<option value=''>Seleccion√° tu iPhone</option>";
    tradeInCatalog.forEach(item=>{
      const label = `${item.model} ${item.storage} ‚Äî USD ${item.usd}`;
      // value: JSON string para recuperar todo sin depender del texto
      tradeInSelect.innerHTML += `<option value='${JSON.stringify(item)}'>${label}</option>`;
    });

    // iPhone a comprar (bloqueado al seleccionado en la card)
    const selected = products[i];
    buySelect.innerHTML = `<option value="${selected.priceUSD}">${selected.model} ${selected.storage}</option>`;
  }

  function closeModal(){
    modal.style.display="none";
    result.innerHTML="";
  }

  // click fuera para cerrar
  modal.addEventListener("click",(e)=>{ if(e.target===modal) closeModal(); });

  /* =========================
     C√ÅLCULO CANJE
  ========================== */
  tradeInSelect.addEventListener("change",()=>{
    if(!tradeInSelect.value){
      result.innerHTML="";
      whatsappBtn.href="#";
      return;
    }

    const trade = JSON.parse(tradeInSelect.value);
    const buyUsd = Number(buySelect.value);

    const diffUsd = buyUsd - trade.usd;
    const pr = calculatePrices(diffUsd);

    const buyLabel = buySelect.options[0].text;

    result.innerHTML=`
      <strong>Diferencia a pagar</strong><br><br>
      <span style="color:var(--usd);font-weight:900">USD ${pr.usd}</span><br>
      ARS ${pr.ars.toLocaleString()}<br><br>
      3 cuotas: ARS ${pr.c3.toLocaleString()}<br>
      6 cuotas: ARS ${pr.c6.toLocaleString()}
    `;

    const msg =
`Hola! Quiero canjear mi iPhone.

üì≤ Entrego: ${trade.model} ${trade.storage} (USD ${trade.usd})
‚úÖ Quiero: ${buyLabel}

üí∞ Diferencia estimada:
- USD ${pr.usd}
- ARS ${pr.ars.toLocaleString()}
- 3 cuotas: ARS ${pr.c3.toLocaleString()}
- 6 cuotas: ARS ${pr.c6.toLocaleString()}

¬øMe ayud√°s a avanzar con el canje?`;

    // Si no configuraste el n√∫mero, deja el link vac√≠o
    if(!WHATSAPP_NUMBER || WHATSAPP_NUMBER.includes("X")){
      whatsappBtn.href="#";
    } else {
      whatsappBtn.href = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
    }
  });

  /* =========================
     FILTROS / ORDEN
  ========================== */
  document.getElementById("filterLine").onchange=renderProducts;
  document.getElementById("filterCondition").onchange=renderProducts;
  document.getElementById("sortPrice").onchange=renderProducts;

  document.getElementById("clearFilters").onclick=()=>{
    filterLine.value="";
    filterCondition.value="";
    sortPrice.value="";
    renderProducts();
  };

  renderProducts();
</script>

</body>
</html>
